# ProxyServer

---
**ИСКЛЮЧИТЕЛЬНО В ОБРАЗОВАТЕЛЬНЫХ ЦЕЛЯХ**
---

## Описание

**ProxyServer** — это простой прокси-сервер, реализованный с использованием протокола SOCKS5 и SSL/TLS для защиты соединений. Проект поддерживает работу с несколькими клиентами одновременно и может использоваться для безопасного пересылания данных через защищённые каналы.

Прокси-сервер реализует базовые функции SOCKS5 (подключение к целевым серверам), а также шифрует трафик с помощью SSL/TLS для обеспечения безопасности.

## Особенности

Благодаря использованию 443 порта и SSL соединения весь трафик сервера выглядит как обычный HTTPS не зависимо от того, что на самом деле он в себе содержит. Кроме того, если говорить о блокировках и ограничении провайдеров - они не заблокируют трафик с порта 443 и не смогут заподозрить даже факт использования прокси.

## Возможности

- Подключение по протоколу SOCKS5.
- Шифрование трафика с использованием SSL/TLS.
- Поддержка IPv4, IPv6 и доменных имен в качестве целевых адресов.
- Многозадачность (обработка нескольких клиентов одновременно с использованием потоков).
- Совместимость с Windows и Linux.

## Структура проекта

Проект разделён на несколько файлов:

- **`common.h`** — содержит все необходимые библиотеки и общие настройки.
- **`ClientHandler.h`** и **`ClientHandler.cpp`** — класс для обработки клиента.
- **`ConnectionManager.h`** и **`ConnectionManager.cpp`** — класс для управления подключениями.
- **`SSLManager.h`** и **`SSLManager.cpp`** — класс для работы с SSL/TLS.

## Требования

- **C++17** и выше.
- Библиотеки OpenSSL (для работы с SSL/TLS).
- На Windows требуется WinSock.

## Инструкции по сборке

### Сборка с использованием CMake

#### На Linux

1. Убедитесь, что у вас установлены все необходимые зависимости:

    ```bash
    sudo apt-get update
    sudo apt-get install build-essential cmake libssl-dev
    ```

2. Создайте директорию для сборки и перейдите в неё:

    ```bash
    mkdir build
    cd build
    ```

3. Выполните CMake для генерации Makefile:

    ```bash
    cmake ..
    ```

4. Скомпилируйте проект с помощью `make`:

    ```bash
    make
    ```

5. Запустите проект:

    ```bash
    ./proxy_server
    ```

#### На Windows

1. Установите CMake с [официального сайта](https://cmake.org/download/).
2. Установите Visual Studio (рекомендуется использовать Visual Studio 2019 или новее).
3. Установите OpenSSL. Для этого вы можете скачать OpenSSL для Windows или использовать [vcpkg](https://github.com/microsoft/vcpkg) для установки.

4. Откройте CMake и укажите корневую папку проекта в качестве исходной директории.
5. В разделе **"Where to build the binaries"** укажите директорию для сборки (например, `build`).
6. Нажмите **"Configure"**, затем **"Generate"**.
7. Откройте сгенерированный `.sln` файл в Visual Studio.
8. Соберите проект, выбрав **Build > Build Solution** в Visual Studio.

После этого, в директории `Debug` или `Release` (в зависимости от конфигурации сборки) будет создан исполняемый файл `proxy_server.exe`.

### Запуск

После успешной сборки проекта, вы можете запустить сервер с командной строки:

#### На Linux:

```bash
./proxy_server
```

#### На Windows:

Запустите proxy_server.exe через командную строку или дважды кликнув на ярлык приложения.


# Подключение к ProxyServer

## Подключение через ProxyCap на Windows

1. Скачайте и установите [ProxyCap](https://www.proxycap.com/).

2. Откройте ProxyCap и перейдите в раздел **Profiles**.

3. Нажмите **New Profile**, чтобы создать новый профиль прокси-сервера.

4. В поле **Proxy Server** укажите IP-адрес и порт вашего сервера (например, `localhost:443`).

5. В поле **Proxy Type** выберите **SOCKS5**.

6. Перейдите в раздел **SSL/TLS**. Если ваш сервер использует SSL/TLS для шифрования соединений, включите поддержку SSL, поставив галочку на **Enable SSL/TLS encryption**.

7. В поле **Certificate File** укажите путь к вашему SSL-сертификату (если это необходимо для проверки на сервере).

8. Нажмите **OK**, чтобы сохранить профиль.

9. Примените настройки, выбрав **Enable ProxyCap**.

---

## Подключение на Linux

Для подключения к ProxyServer на Linux с настройкой SSL-сертификата, выполните следующие шаги:

1. Убедитесь, что у вас установлен OpenSSL и ваши сертификаты находятся на месте.

    Установите OpenSSL, если он не установлен:

    ```bash
    sudo apt-get update
    sudo apt-get install openssl
    ```

2. Скачайте и установите **`proxychains`** для проксирования:

    ```bash
    sudo apt-get install proxychains
    ```

3. Откройте файл конфигурации **`proxychains.conf`** для настройки:

    ```bash
    sudo nano /etc/proxychains.conf
    ```

4. Внизу файла добавьте строку для подключения к вашему серверу через SOCKS5:

    ```
    socks5 127.0.0.1 443
    ```

5. Для настройки SSL-соединения, если оно используется, необходимо указать путь к SSL-сертификату в вашем приложении или использовать OpenSSL для работы с ним. Пример использования OpenSSL:

    ```bash
    openssl s_client -connect 127.0.0.1:443 -CAfile /path/to/your/certificate.crt
    ```

6. Теперь вы можете запустить любое приложение, проксируя трафик через ваш сервер:

    ```bash
    proxychains curl http://example.com
    ```

---

## Подключение с Android

Для подключения с Android через ProxyServer с настройкой SSL-сертификата выполните следующие шаги:

1. Установите приложение **ProxyDroid** (доступно в Google Play).

2. Откройте **ProxyDroid** и настройте прокси:

    - Включите **Enable Proxy**.
    - Введите IP-адрес вашего прокси-сервера и порт (например, `localhost:443`).
    - В разделе **Proxy Type** выберите **SOCKS5**.

3. Для подключения через SSL-сертификат выполните следующие шаги:

    - Скачайте SSL-сертификат на ваше Android-устройство и установите его. Для этого перейдите в **Настройки > Безопасность > Установить с SD-карты**.
    - Выберите файл сертификата и установите его.

4. После этого включите прокси в **ProxyDroid** и все трафик с Android-устройства будет проксироваться через ваш сервер с использованием SSL/TLS.

---

## Подключение с iOS

Для подключения к ProxyServer на iOS с использованием SSL-сертификата выполните следующие шаги:

1. Перейдите в **Настройки > Wi-Fi** и выберите вашу сеть.

2. Прокрутите вниз и выберите **Настройки прокси-сервера**.

3. Установите **Тип прокси** на **SOCKS5**.

4. В поле **Сервер** укажите IP-адрес вашего прокси-сервера (например, `localhost` или ваш публичный IP).

5. В поле **Порт** укажите порт, который используется для подключения (например, `443`).

6. Если требуется SSL-сертификат, скопируйте его на ваше устройство и установите:

    - Откройте файл сертификата, переданный на устройство, и нажмите **Установить**.
    - В **Настройки > Профили** подтвердите установку сертификата.

7. Включите прокси, и ваше устройство будет использовать ProxyServer для всех соединений через SOCKS5 с поддержкой SSL.

---

## Подключение на macOS

Для подключения к ProxyServer на macOS выполните следующие шаги:

1. Откройте **Системные настройки** и перейдите в **Сеть**.

2. Выберите ваш активный интерфейс (например, Wi-Fi) и нажмите **Дополнительно**.

3. Перейдите на вкладку **Прокси** и поставьте галочку на **SOCKS Proxy**.

4. Введите IP-адрес вашего прокси-сервера в поле **Адрес** (например, `localhost` или ваш публичный IP).

5. В поле **Порт** укажите порт для подключения (например, `443`).

6. Для использования SSL-сертификата, если это необходимо, скопируйте сертификат на ваше устройство и установите его через **Настройки > Профили**.

7. Примените настройки и закройте окно. Теперь весь трафик будет проксироваться через ваш сервер.

---


